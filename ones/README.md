# Всякая шняга на 1С

В этом каталоге находятся примеры разработки 1С приложения с использованием
инструментария [Ruby Powered Workflow](https://github.com/leoniv/ruby_powered_workflow)

Некоторые инструменты [RPW](https://github.com/leoniv/ruby_powered_workflow)
еще находятся в нестабильном состоянии поэтому данный пример надо рассматривать
как подтверждение концепции, а концепция реально работает.

Содержание каталогов:

- [src/](src/) - разобранное в xml файлы приложение 1С (aka Конфигурация). В
директории две папки в одной конфигурация-конфигрурации :) в другой конфигурация
базы данных. Такое хранение наверно избыточно но пока так.
- [test/](test/) - тесты приложения 1С написанные на Ruby с использованием
тестового фреймворка **Minites** и инструментария
[RPW](https://github.com/leoniv/ruby_powered_workflow)
- [lib/](lib) - Ruby обвязка описывающая спецификации разрабатываемого
приложения. Lib наверно не самое лучшее название, но пока так.

## Как с этим поиграться

### Окружение

- OC Widows старше Windows XP
- UNIX окружение [cygwin](https://www.cygwin.com). Используйте 32-х разрядный
вариант установки cygwin [setup-x86.exe](https://www.cygwin.com/setup-x86.exe)
Далее все действия описаны для cygwin.
- установленный в cygwin 32-х разрядный Ruby версии старше 2.0
- установите утилиты сборки gcc make и т.п. и пакет с заголовочниками Ruby
(что-от типа ruby-devel) они пригодятся при установке gem-ов
- установите утилиту bundler `gem install bundler`
- ну и конечно должна быть установлена платформа 1С
**Важно! Нужна 32х разрядная** платформа версии указанной в константе
`PLATFORM_REQUIRE` объявленной в файле [lib/hackathon.rb](lib/hackathon.rb)

Далее все действия описаны для терминала cygwin

### Клонируйте репу и загрузите Ruby зависимости

    $git clone https://github.com/leoniv/hackathon.git &&\
     cd hackathon/ones && bundler install

### Зпустите тесты находясь в каталоге `ones`

    $bundler exec rake design:test

Если тесты запустились тогда окружение настроено правильно и можно поиграть

### Порядок разработки 1С приложения

Вам понадобится два открытых терминала и любимый текстовый редактор который
понимает Ruby.

В первом терминале запустите "цикл дизайна":

    $bundler exec rake design:run

При этом будет собрана файловая база из исходников `src` и открыт конфигуратор.
Терминал останется занятым до момента закрытия конфигуратора. После того как
конфигуратор будет закрыт, "цикл дизайна" выгрузит конфигурацию из базы в
каталог `src` и запустит команду `git add`. **Важно!** корректно закрывайте
конфигуратор, не используйте ctrl-c.

Пишите тесты на Ruby в редакторе, пишите код 1С в конфигураторе, сохраняйте
правки в конфигурацию базы данных и запускайте во втором терминале тесты:

все тесты

    $bundler exec rake design:test

или с фильтром по рег. выражению:

    $bundler exec rake design:test TESTOPTS='--name=/пустой\ кидает\ исключени/i'`

## Enjoy with Ruby :)
